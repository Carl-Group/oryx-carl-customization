#!/usr/bin/env bash

echo "Init global script"

# If the containers/data is invalid, we need to create it.
if [[ ! -d containers/data ]]; then rm -rf containers/data; fi

# Always make sure the containers/data directory exists.
mkdir -p containers/data containers/data/redis containers/data/config containers/data/dvr \
  containers/data/record containers/data/vod containers/data/upload containers/data/vlive &&
echo "MGMT create containers directory"
if [[ $? -ne 0 ]]; then echo "MGMT create containers directory failed"; exit 1; fi

# Because .env might be moved to config, so we link it.
touch containers/data/config/.env &&
rm -f .env && ln -sf containers/data/config/.env .env
if [[ $? -ne 0 ]]; then echo "MGMT link .env failed"; exit 1; fi

